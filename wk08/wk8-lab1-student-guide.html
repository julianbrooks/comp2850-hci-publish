<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Student Guide: Code Reading &amp; Documentation - COMP2850 • Human-Computer Interaction</title>


        <!-- Custom HTML head -->

        <meta name="description" content="HCI module covering server-first architecture, accessibility, privacy by design, and evaluation (Weeks 6-11)">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../css/admonish.css">
        <link rel="stylesheet" href="../css/custom.css">
        <link rel="stylesheet" href="../css/retro-theme.css">
        <link rel="stylesheet" href=".././mdbook-admonish.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "navy";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">COMP2850 • Human-Computer Interaction</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="week-8--lab-1--student-guide-code-reading--documentation"><a class="header" href="#week-8--lab-1--student-guide-code-reading--documentation">Week 8 • Lab 1 — Student Guide: Code Reading &amp; Documentation</a></h1>
<p><img src="https://img.shields.io/badge/COMP2850-HCI-blue" alt="COMP2850" />
<img src="https://img.shields.io/badge/Week-8-orange" alt="Week 8" />
<img src="https://img.shields.io/badge/Lab-1-green" alt="Lab 1" />
<img src="https://img.shields.io/badge/Type-Student_Guide-purple" alt="Guide" /></p>
<blockquote>
<p><strong>Purpose</strong>: If you found the Week 8 Lab 1 implementation challenging, this guide provides working code so you can focus on <strong>understanding patterns</strong> and <strong>documenting trade-offs</strong> rather than fighting syntax. The goal is to understand HCI concepts (pagination constraints, accessibility, dual-mode architecture), not to become a Kotlin expert.</p>
</blockquote>
<hr />
<h2 id="how-to-use-this-guide"><a class="header" href="#how-to-use-this-guide">How to Use This Guide</a></h2>
<p><strong>If you’ve already written working pagination/filtering code:</strong> Skip Part 1, go straight to Part 2 (verification and documentation).</p>
<p><strong>If you’re stuck on implementation:</strong> Use Part 1 code, then complete Parts 2 &amp; 3 (verification + documentation).</p>
<hr />
<h2 id="part-1-working-implementation-optional"><a class="header" href="#part-1-working-implementation-optional">Part 1: Working Implementation (Optional)</a></h2>
<blockquote>
<p><strong>Important</strong>: This code is provided to help you focus on <strong>learning HCI concepts</strong>, not as a shortcut. You must understand the design decisions and document them in Part 3.</p>
</blockquote>
<details>
<summary>Click to reveal: <code>src/main/kotlin/data/Page.kt</code> (new file)</summary>
<pre><code class="language-kotlin">package data

/**
 * Generic pagination container.
 * Wraps a list of items with metadata for page navigation.
 */
data class Page&lt;T&gt;(
    val items: List&lt;T&gt;,
    val page: Int,
    val pages: Int,
    val total: Int
) {
    val hasPrevious: Boolean get() = page &gt; 1
    val hasNext: Boolean get() = page &lt; pages
    val previousPage: Int get() = page - 1
    val nextPage: Int get() = page + 1
}
</code></pre>
</details>
<details>
<parameter name="summary">Click to reveal: Add to <code>TaskRepository</code> object</summary>
<pre><code class="language-kotlin">/**
 * Search tasks by title and return paginated results.
 */
fun search(query: String, page: Int, pageSize: Int = 10): Page&lt;Task&gt; {
    val filtered = if (query.isBlank()) {
        all()
    } else {
        all().filter { task -&gt;
            task.title.contains(query, ignoreCase = true)
        }
    }

    val totalItems = filtered.size
    val totalPages = if (totalItems == 0) 1 else (totalItems + pageSize - 1) / pageSize
    val validPage = page.coerceIn(1, totalPages)
    val startIndex = (validPage - 1) * pageSize
    val pageItems = filtered.drop(startIndex).take(pageSize)

    return Page(
        items = pageItems,
        page = validPage,
        pages = totalPages,
        total = totalItems
    )
}
</code></pre>
</details>
<details>
<summary>Click to reveal: Add to <code>TaskRoutes.kt</code></summary>
<pre><code class="language-kotlin">// Fragment endpoint for HTMX updates
get("/tasks/fragment") {
    val q = call.request.queryParameters["q"]?.trim().orEmpty()
    val page = call.request.queryParameters["page"]?.toIntOrNull() ?: 1
    val pageData = TaskRepository.search(q, page, 10)

    val list = call.renderTemplate("tasks/_list.peb", mapOf("page" to pageData, "q" to q))
    val pager = call.renderTemplate("tasks/_pager.peb", mapOf("page" to pageData, "q" to q))
    val status = """&lt;div id="status" hx-swap-oob="true"&gt;Updated: showing ${pageData.items.size} of ${pageData.total} tasks&lt;/div&gt;"""

    call.respondText(list + pager + status, ContentType.Text.Html)
}

// Update existing GET /tasks to use pagination
get("/tasks") {
    val q = call.request.queryParameters["q"]?.trim().orEmpty()
    val page = call.request.queryParameters["page"]?.toIntOrNull() ?: 1
    val pageData = TaskRepository.search(q, page, 10)

    val html = call.renderTemplate("tasks/index.peb", mapOf(
        "page" to pageData,
        "q" to q,
        "title" to "Tasks"
    ))
    call.respondText(html, ContentType.Text.Html)
}
</code></pre>
</details>
<details>
<summary>Click to reveal: <code>src/main/resources/templates/tasks/_list.peb</code> (new file)</summary>
<pre><code class="language-pebble">{# Task list partial with accessible result count #}
&lt;ul id="task-list" aria-describedby="result-count"&gt;
  {% for task in page.items %}
    {% include "tasks/_item.peb" with {"task": task} %}
  {% endfor %}
&lt;/ul&gt;

{# WCAG 4.1.3: Result count for people using assistive technology #}
&lt;p id="result-count" class="visually-hidden"&gt;
  Showing {{ page.items|length }} of {{ page.total }} tasks{% if q %} matching "{{ q }}"{% endif %}
&lt;/p&gt;
</code></pre>
</details>
<details>
<summary>Click to reveal: <code>src/main/resources/templates/tasks/_pager.peb</code> (new file)</summary>
<pre><code class="language-pebble">{# Pagination navigation with dual-mode support (HTMX + no-JS) #}
&lt;nav aria-label="Pagination"&gt;
  &lt;ul class="pagination"&gt;
    {% if page.hasPrevious %}
      &lt;li&gt;
        &lt;a href="/tasks?q={{ q|default('') }}&amp;page={{ page.previousPage }}"
           hx-get="/tasks/fragment?q={{ q|default('') }}&amp;page={{ page.previousPage }}"
           hx-target="#task-area"
           hx-push-url="true"&gt;
          Previous
        &lt;/a&gt;
      &lt;/li&gt;
    {% endif %}

    &lt;li aria-current="page"&gt;
      Page {{ page.page }} of {{ page.pages }}
    &lt;/li&gt;

    {% if page.hasNext %}
      &lt;li&gt;
        &lt;a href="/tasks?q={{ q|default('') }}&amp;page={{ page.nextPage }}"
           hx-get="/tasks/fragment?q={{ q|default('') }}&amp;page={{ page.nextPage }}"
           hx-target="#task-area"
           hx-push-url="true"&gt;
          Next
        &lt;/a&gt;
      &lt;/li&gt;
    {% endif %}
  &lt;/ul&gt;
&lt;/nav&gt;
</code></pre>
</details>
<details>
<summary>Click to reveal: Modifications to <code>tasks/index.peb</code></summary>
<pre><code class="language-pebble">{% extends "_layout/base.peb" %}
{% block content %}

&lt;h1&gt;Tasks&lt;/h1&gt;

{# Add Task Form - targets #task-area (not #task-list) for Week 8 #}
&lt;form action="/tasks" method="post"
      hx-post="/tasks"
      hx-target="#task-area"
      hx-swap="innerHTML"
      hx-on::after-request="this.reset()"&gt;
  &lt;label for="title"&gt;Title&lt;/label&gt;
  &lt;input type="text" id="title" name="title" required aria-describedby="title-hint"&gt;
  &lt;small id="title-hint"&gt;Keep it short and specific.&lt;/small&gt;
  &lt;button type="submit"&gt;Add Task&lt;/button&gt;
&lt;/form&gt;

{# Filter Form - dual-mode (HTMX + no-JS) #}
&lt;form action="/tasks" method="get"
      hx-get="/tasks/fragment"
      hx-target="#task-area"
      hx-push-url="true"
      hx-trigger="keyup changed delay:300ms from:#q, submit"&gt;
  &lt;label for="q"&gt;Filter tasks&lt;/label&gt;
  &lt;input type="search"
         id="q"
         name="q"
         value="{{ q|default('') }}"
         aria-describedby="q-hint"&gt;
  &lt;small id="q-hint"&gt;Type to filter (debounced 300ms); works without JavaScript.&lt;/small&gt;
  &lt;button type="submit"&gt;Apply Filter&lt;/button&gt;
&lt;/form&gt;

{# Task area wrapper for HTMX targeting #}
&lt;div id="task-area"&gt;
  {% include "tasks/_list.peb" %}
  {% include "tasks/_pager.peb" %}
&lt;/div&gt;

{% endblock %}
</code></pre>
<p><strong>Key changes from Week 7:</strong></p>
<ul>
<li>Add Task form now targets <code>#task-area</code> (not <code>#task-list</code>) with <code>innerHTML</code> swap (not <code>beforeend</code>)</li>
<li>This is because the server response includes the full list + pagination, not just a single <code>&lt;li&gt;</code></li>
</ul>
</details>
<hr />
<h2 id="part-2-verification-checklist"><a class="header" href="#part-2-verification-checklist">Part 2: Verification Checklist</a></h2>
<p>Test your implementation works correctly:</p>
<h3 id="dual-mode-testing"><a class="header" href="#dual-mode-testing">Dual-Mode Testing</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>With JavaScript enabled</strong>: Type in filter box → observe smooth updates without page reload</li>
<li><input disabled="" type="checkbox"/>
<strong>With JavaScript disabled</strong>: Click “Apply Filter” → observe full page reload with correct results</li>
<li><input disabled="" type="checkbox"/>
<strong>Pagination links</strong>: Both Previous/Next work in JS and no-JS modes</li>
</ul>
<h3 id="accessibility-testing"><a class="header" href="#accessibility-testing">Accessibility Testing</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>Keyboard navigation</strong>: Tab through filter form → pagination → tasks (logical order, visible focus)</li>
<li><input disabled="" type="checkbox"/>
<strong>Screen reader</strong> (if available): Filter tasks → result count is announced</li>
<li><input disabled="" type="checkbox"/>
<strong>No-JS parity</strong>: All features work identically with JavaScript disabled</li>
</ul>
<h3 id="url-and-history"><a class="header" href="#url-and-history">URL and History</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>Browser URL bar</strong>: Reflects current filter and page (<code>?q=search&amp;page=2</code>)</li>
<li><input disabled="" type="checkbox"/>
<strong>Back button</strong>: Returns to previous filter/page state</li>
<li><input disabled="" type="checkbox"/>
<strong>Bookmarking</strong>: Filtered/paginated URL returns to same state when reopened</li>
</ul>
<h3 id="edge-cases"><a class="header" href="#edge-cases">Edge Cases</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
<strong>Empty filter results</strong>: Shows appropriate message</li>
<li><input disabled="" type="checkbox"/>
<strong>Invalid page number</strong> (e.g., <code>?page=999</code>): Handled gracefully</li>
<li><input disabled="" type="checkbox"/>
<strong>Adding task while filtered</strong>: Task appears if it matches filter</li>
</ul>
<p>Record any issues in your backlog (<code>wk08/backlog/issues.csv</code>).</p>
<hr />
<h2 id="part-3-documentation-deliverable"><a class="header" href="#part-3-documentation-deliverable">Part 3: Documentation Deliverable</a></h2>
<p>Create <code>wk08/docs/prototyping-constraints.md</code> using this template:</p>
<pre><code class="language-markdown"># Prototyping Constraints &amp; Trade-offs

## Rendering splits
- Full page: [describe what `/tasks` returns and when it's used]
- Fragment: [describe what `/tasks/fragment` returns and when it's used]

## URL &amp; History
- [Explain how `hx-push-url="true"` maintains browser history]
- [What breaks if you remove it?]

## Accessibility hooks
- [Describe the live region `#status` and its purpose]
- [Explain `aria-describedby` connection between list and result count]
- [Why is result count visually hidden?]

## State management
- [How do query parameters (`q`, `page`) maintain state?]
- [Why must pagination links include the filter query?]

## Performance notes
- Page size: [your choice - justify it]
- Fragment response size vs full page: [estimate bandwidth savings]
- Debounce delay: [300ms - why this value?]

## Future risks
- [What could go wrong with this approach?]
- [Scalability concerns (e.g., 10,000 tasks)?]
- [Template maintenance burden?]

## Accessibility verification

### Keyboard testing
- [Results from Tab navigation test]

### Screen reader testing
- [If available: what was announced when filtering?]

### No-JS parity
- [Confirmation that all features work without JavaScript]
</code></pre>
<p><strong>Word limit</strong>: ~400-500 words total (concise bullet points preferred)</p>
<hr />
<h2 id="assessment"><a class="header" href="#assessment">Assessment</a></h2>
<p>Your work is assessed on:</p>
<ul>
<li><strong>Understanding</strong>: Clear explanation of dual-mode pattern</li>
<li><strong>Trade-off analysis</strong>: Thoughtful consideration of performance, accessibility, maintenance</li>
<li><strong>Evidence</strong>: Testing results documented</li>
</ul>
<p><strong>Not assessed</strong>: Whether you wrote the code from scratch or used the provided implementation.</p>
<hr />
<h2 id="commit--continue"><a class="header" href="#commit--continue">Commit &amp; Continue</a></h2>
<pre><code class="language-bash">git add templates/ src/ wk08/docs/prototyping-constraints.md
git commit -m "wk8s1: pagination + filtering with dual-mode support"
</code></pre>
<p>Proceed to <strong>Week 8 Lab 2</strong> for validation and no-JS parity verification.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../wk08/wk8-lab1-prototyping-constraints.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../wk08/wk8-lab2-routing-nojs-tradeoffs.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../wk08/wk8-lab1-prototyping-constraints.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../wk08/wk8-lab2-routing-nojs-tradeoffs.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
