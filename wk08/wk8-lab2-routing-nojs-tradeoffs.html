<!DOCTYPE HTML>
<html lang="en" class="navy sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Lab 2: Routing parity, no-JS verification, trade-offs - COMP2850 ‚Ä¢ Human-Computer Interaction</title>


        <!-- Custom HTML head -->

        <meta name="description" content="HCI module covering server-first architecture, accessibility, privacy by design, and evaluation (Weeks 6-11)">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../css/admonish.css">
        <link rel="stylesheet" href="../css/custom.css">
        <link rel="stylesheet" href="../css/retro-theme.css">
        <link rel="stylesheet" href=".././mdbook-admonish.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "navy";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">COMP2850 ‚Ä¢ Human-Computer Interaction</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="week-8--lab-2--wire-routes-verify-no-js-parity-capture-trade-offs"><a class="header" href="#week-8--lab-2--wire-routes-verify-no-js-parity-capture-trade-offs">Week 8 ‚Ä¢ Lab 2 ‚Äî Wire Routes, Verify No-JS Parity, Capture Trade-offs</a></h1>
<p><img src="https://img.shields.io/badge/COMP2850-HCI-blue" alt="COMP2850" />
<img src="https://img.shields.io/badge/Week-8-orange" alt="Week 8" />
<img src="https://img.shields.io/badge/Lab-2-green" alt="Lab 2" />
<img src="https://img.shields.io/badge/Status-Draft-yellow" alt="Status" /></p>
<hr />
<h2 id="before-lab-required-reading-15-mins"><a class="header" href="#before-lab-required-reading-15-mins">Before Lab: Required Reading (15 mins)</a></h2>
<p>üìñ <strong>Essential</strong></p>
<ul>
<li>Ensure Week 8 starter repo updates (pagination work) are committed/pushed</li>
<li><a href="https://htmx.org/reference/#events">HTMX: Events Reference</a> (htmx:responseError, htmx:beforeSwap)</li>
<li><a href="https://htmx.org/attributes/hx-confirm/">HTMX: hx-confirm</a></li>
<li><a href="https://webaim.org/articles/formvalidation/">WebAIM: Forms - Accessible Error Identification</a></li>
</ul>
<p>üìñ <strong>Contextual</strong>:</p>
<ul>
<li>Review <a href="../references/htmx-pattern-cheatsheet.html">HTMX Pattern Cheatsheet</a> (OOB pattern)</li>
<li>Review <a href="../references/assistive-testing-checklist.html">Assistive Testing Checklist</a></li>
<li>Review Week 7 Lab 1 inline edit implementation</li>
</ul>
<hr />
<h2 id="introduction-from-prototype-to-production-ready"><a class="header" href="#introduction-from-prototype-to-production-ready">Introduction: From Prototype to Production-Ready</a></h2>
<p>Yesterday (Week 8 Lab 1) you added pagination and filtering. The <strong>happy path</strong> works: people can browse, filter, and page through tasks.</p>
<p><strong>Today's reality check</strong>: What happens when:</p>
<ul>
<li>Someone submits an empty form?</li>
<li>JavaScript is disabled or fails to load?</li>
<li>A person uses only keyboard navigation?</li>
<li>Network drops mid-request?</li>
</ul>
<p><strong>Production systems must handle failure gracefully</strong>. This lab hardens your prototype:</p>
<ol>
<li><strong>Validation</strong>: Server-side validation with accessible error messaging</li>
<li><strong>Parity</strong>: Identical functionality with/without JavaScript</li>
<li><strong>Testing</strong>: Repeatable verification scripts</li>
<li><strong>Documentation</strong>: Trade-offs, risks, mitigations</li>
</ol>
<p><strong>HCI Connection</strong>: Robust error handling is an <strong>inclusion imperative</strong>‚Äîvalidation errors disproportionately affect people with cognitive disabilities, screen reader users, and those with unreliable connectivity. WCAG 3.3 (Input Assistance) requires clear, accessible error identification.</p>
<hr />
<h2 id="learning-focus"><a class="header" href="#learning-focus">Learning Focus</a></h2>
<h3 id="lab-objectives"><a class="header" href="#lab-objectives">Lab Objectives</a></h3>
<p>By the end of this session, you will have:</p>
<ul>
<li>Validated form inputs with accessible error messaging</li>
<li>Ensured create/edit/delete work identically with and without JavaScript</li>
<li>Tested no-JS parity with repeatable scripts</li>
<li>Documented design trade-offs (progressive enhancement vs SPA) and mitigation strategies</li>
<li>Verified accessibility of error states with keyboard and screen reader</li>
</ul>
<h3 id="learning-outcomes-addressed"><a class="header" href="#learning-outcomes-addressed">Learning Outcomes Addressed</a></h3>
<p>This lab contributes to the following module Learning Outcomes (<a href="../references/learning-outcomes.html">full definitions</a>):</p>
<ul>
<li><strong>LO7</strong>: Analyse design constraints ‚Äî evidenced by no-JS parity testing + trade-offs doc</li>
<li><strong>LO9</strong>: Apply inclusive design ‚Äî evidenced by no-JS accessibility verification</li>
<li><strong>LO13</strong>: Integrate HCI with SE ‚Äî evidenced by routing patterns</li>
</ul>
<hr />
<h2 id="key-concepts"><a class="header" href="#key-concepts">Key Concepts</a></h2>
<h3 id="server-side-validation"><a class="header" href="#server-side-validation">Server-Side Validation</a></h3>
<blockquote>
<p><strong>Server-Side Validation</strong> [GLOSSARY]</p>
<p>Validation logic executed on the server (not browser). <strong>Always required</strong>, even with client-side validation.</p>
<p><strong>Why</strong>:</p>
<ul>
<li>Client-side can be bypassed (disabled JS, malicious requests)</li>
<li>Security boundary: never trust client input</li>
<li>Accessibility: server can return appropriate error responses for HTMX and no-JS paths</li>
</ul>
<p><strong>Pattern</strong>:</p>
<pre><code class="language-kotlin">val title = call.receiveParameters()["title"].orEmpty().trim()
if (title.isBlank()) {
    // Return error response (HTML for HTMX, redirect for no-JS)
}
</code></pre>
<p><strong>HCI Connection</strong>: Server validation enables <strong>progressive enhancement</strong>‚Äîsame validation logic serves both enhanced (HTMX) and baseline (HTML-only) experiences.</p>
<p>üîó <a href="https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html">OWASP: Input Validation</a></p>
</blockquote>
<h3 id="post-redirect-get-prg-pattern"><a class="header" href="#post-redirect-get-prg-pattern">Post-Redirect-Get (PRG) Pattern</a></h3>
<blockquote>
<p><strong>Post-Redirect-Get (PRG)</strong> [GLOSSARY]</p>
<p>Respond to successful POST with redirect (303) instead of HTML. Prevents duplicate submissions on browser refresh.</p>
<p><strong>Flow</strong>:</p>
<ol>
<li>Person submits form ‚Üí <code>POST /tasks</code></li>
<li>Server validates, saves task</li>
<li>Server responds <code>303 See Other</code> ‚Üí <code>Location: /tasks</code></li>
<li>Browser follows redirect ‚Üí <code>GET /tasks</code></li>
<li>Person sees updated task list</li>
</ol>
<p><strong>Why</strong>:</p>
<ul>
<li>Refresh reloads <code>GET /tasks</code> (safe), not <code>POST /tasks</code> (duplicate)</li>
<li>Back button works predictably</li>
<li>URL reflects current state</li>
</ul>
<p><strong>Kotlin (Ktor)</strong>:</p>
<pre><code class="language-kotlin">post("/tasks") {
    // Validate and save...
    if (!call.isHtmx()) {
        call.respondRedirect("/tasks", permanent = false)
    }
}
</code></pre>
<p><strong>HCI Connection</strong>: PRG reduces cognitive load‚Äîback/forward/refresh do what people expect. Critical for accessibility (people often use back button to recover from errors).</p>
<p>üîó <a href="https://en.wikipedia.org/wiki/Post/Redirect/Get">Wikipedia: Post/Redirect/Get</a></p>
</blockquote>
<h3 id="dual-path-architecture"><a class="header" href="#dual-path-architecture">Dual-Path Architecture</a></h3>
<blockquote>
<p><strong>Dual-Path Architecture</strong> [GLOSSARY]</p>
<p>Single server route handles both HTMX (enhanced) and no-JS (baseline) requests with different responses.</p>
<p><strong>Detection</strong>:</p>
<pre><code class="language-kotlin">fun ApplicationCall.isHtmx(): Boolean =
    request.headers["HX-Request"]?.equals("true", ignoreCase = true) == true
</code></pre>
<p><strong>Response Strategy</strong>:</p>
<ul>
<li><strong>HTMX path</strong>: Return HTML fragment + OOB status</li>
<li><strong>No-JS path</strong>: Return full page or redirect (PRG)</li>
</ul>
<p><strong>Example</strong>:</p>
<pre><code class="language-kotlin">post("/tasks") {
    val title = call.receiveParameters()["title"].orEmpty().trim()
    if (title.isBlank()) {
        if (call.isHtmx()) {
            val status = """&lt;div id="status" hx-swap-oob="true"&gt;Title is required.&lt;/div&gt;"""
            return@post call.respondText(status, ContentType.Text.Html, HttpStatusCode.BadRequest)
        } else {
            return@post call.respondRedirect("/tasks?error=title")
        }
    }
    // Success path...
}
</code></pre>
<p><strong>HCI Connection</strong>: Dual-path ensures <strong>functional parity</strong> across technical contexts‚Äîequivalent experience regardless of JavaScript availability.</p>
<p>üîó <a href="https://hypermedia.systems/progressive-enhancement/">hypermedia.systems: Progressive Enhancement</a></p>
</blockquote>
<h3 id="accessible-error-identification"><a class="header" href="#accessible-error-identification">Accessible Error Identification</a></h3>
<blockquote>
<p><strong>Accessible Error Identification</strong> [GLOSSARY]</p>
<p>WCAG 3.3.1 (Level A): Errors must be identified in text and associated with the problematic input.</p>
<p><strong>Requirements</strong>:</p>
<ol>
<li>Error message in text (not just colour/icon)</li>
<li>Programmatic association (<code>aria-describedby</code> or <code>aria-errormessage</code>)</li>
<li>Focus management (keyboard users land on/near error)</li>
<li>Screen reader announcement (live region or summary)</li>
</ol>
<p><strong>Pattern (inline)</strong>:</p>
<pre><code class="language-html">&lt;label for="title"&gt;Task title&lt;/label&gt;
&lt;input id="title" name="title" aria-describedby="title-error" aria-invalid="true"&gt;
&lt;p id="title-error" role="alert"&gt;Title is required. Please enter at least one character.&lt;/p&gt;
</code></pre>
<p><strong>Pattern (summary)</strong>:</p>
<pre><code class="language-html">&lt;div role="alert" aria-live="assertive" tabindex="-1" id="error-summary"&gt;
  &lt;h2&gt;There is a problem&lt;/h2&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;a href="#title"&gt;Title is required&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
</code></pre>
<p><strong>HCI Connection</strong>: Clear error identification reduces cognitive load and is critical for screen reader users who can't see visual error states.</p>
<p>üîó <a href="https://www.w3.org/WAI/WCAG22/Understanding/error-identification.html">WCAG 3.3.1: Error Identification</a>
üîó <a href="https://design-system.service.gov.uk/components/error-message/">GOV.UK: Error Message Pattern</a></p>
</blockquote>
<h3 id="no-js-parity-testing"><a class="header" href="#no-js-parity-testing">No-JS Parity Testing</a></h3>
<blockquote>
<p><strong>No-JS Parity Testing</strong> [GLOSSARY]</p>
<p>Verifying that all functionality works identically with JavaScript disabled.</p>
<p><strong>Why</strong>:</p>
<ul>
<li>JavaScript may fail to load (network, CDN, blocker)</li>
<li>Some organisations disable JS for security</li>
<li>Testing baseline ensures server-first architecture is sound</li>
<li>Legal requirement in some jurisdictions (accessibility standards)</li>
</ul>
<p><strong>Methods</strong>:</p>
<ol>
<li><strong>Browser DevTools</strong>: Settings ‚Üí Disable JavaScript</li>
<li><strong>Command-line</strong>: <code>curl</code>, <code>wget</code>, <code>httpie</code></li>
<li><strong>Automated</strong>: Playwright with JS disabled, or server-side rendering tests</li>
</ol>
<p><strong>Checklist items</strong>:</p>
<ul>
<li>Forms submit and validate</li>
<li>Navigation works (links, pagination)</li>
<li>Error messages appear and are accessible</li>
<li>Success feedback is visible</li>
<li>Browser history behaves predictably</li>
</ul>
<p><strong>HCI Connection</strong>: No-JS parity is <strong>progressive enhancement</strong> verification‚Äîensures you're truly building server-first, not HTMX-first.</p>
<p>üîó <a href="https://www.gov.uk/service-manual/technology/using-progressive-enhancement">GOV.UK: Building a resilient frontend</a></p>
</blockquote>
<hr />
<h2 id="activity-a-harden-create-flow-35-min"><a class="header" href="#activity-a-harden-create-flow-35-min">Activity A: Harden Create Flow (35 min)</a></h2>
<p>Yesterday you built <code>POST /tasks</code> for the happy path. Now add validation and dual-path error handling.</p>
<h3 id="step-1-add-server-side-validation-10-min"><a class="header" href="#step-1-add-server-side-validation-10-min">Step 1: Add server-side validation (10 min)</a></h3>
<p><strong>Current code</strong> (Week 8 Lab 1):</p>
<pre><code class="language-kotlin">post("/tasks") {
    val title = call.receiveParameters()["title"].orEmpty().trim()
    val task = repo.add(title)
    if (call.isHtmx()) {
        val item = PebbleRender.render("tasks/_item.peb", mapOf("t" to task))
        val status = """&lt;div id="status" hx-swap-oob="true"&gt;Added "${task.title}".&lt;/div&gt;"""
        return@post call.respondText(item + status, ContentType.Text.Html)
    }
    call.respondRedirect("/tasks")
}
</code></pre>
<p><strong>Problem</strong>: No validation. Empty/whitespace titles are accepted.</p>
<p><strong>Add validation</strong>:</p>
<pre><code class="language-kotlin">post("/tasks") {
    val title = call.receiveParameters()["title"].orEmpty().trim()

    // Validation
    if (title.isBlank()) {
        if (call.isHtmx()) {
            val status = """&lt;div id="status" hx-swap-oob="true"&gt;Title is required.&lt;/div&gt;"""
            return@post call.respondText(status, ContentType.Text.Html, HttpStatusCode.BadRequest)
        } else {
            // No-JS: redirect with error query param
            return@post call.respondRedirect("/tasks?error=title")
        }
    }

    if (title.length &gt; 200) {
        if (call.isHtmx()) {
            val status = """&lt;div id="status" hx-swap-oob="true"&gt;Title too long (max 200 chars).&lt;/div&gt;"""
            return@post call.respondText(status, ContentType.Text.Html, HttpStatusCode.BadRequest)
        } else {
            return@post call.respondRedirect("/tasks?error=title&amp;msg=too_long")
        }
    }

    // Success path
    val task = repo.add(title)
    if (call.isHtmx()) {
        val item = PebbleRender.render("tasks/_item.peb", mapOf("t" to task))
        val status = """&lt;div id="status" hx-swap-oob="true"&gt;Added "${task.title}".&lt;/div&gt;"""
        return@post call.respondText(item + status, ContentType.Text.Html)
    }
    call.respondRedirect("/tasks")
}
</code></pre>
<p><strong>Key points</strong>:</p>
<ul>
<li>Always validate on server (never trust client)</li>
<li>Return <code>400 Bad Request</code> for HTMX errors (semantic HTTP)</li>
<li>Use query parameters for no-JS errors (preserve form state)</li>
</ul>
<h3 id="step-2-update-template-to-show-no-js-errors-15-min"><a class="header" href="#step-2-update-template-to-show-no-js-errors-15-min">Step 2: Update template to show no-JS errors (15 min)</a></h3>
<p><strong>Update <code>templates/tasks/index.peb</code></strong>:</p>
<p>Add error summary at top (before form):</p>
<pre><code class="language-twig">{% if error %}
&lt;div role="alert" aria-live="assertive" class="error-summary" id="error-summary" tabindex="-1"&gt;
  &lt;h2&gt;There is a problem&lt;/h2&gt;
  &lt;ul&gt;
    {% if error == "title" %}
    &lt;li&gt;&lt;a href="#title"&gt;{% if msg == "too_long" %}Title is too long (max 200 characters){% else %}Title is required{% endif %}&lt;/a&gt;&lt;/li&gt;
    {% endif %}
  &lt;/ul&gt;
&lt;/div&gt;
{% endif %}
</code></pre>
<p><strong>Update form input</strong>:</p>
<pre><code class="language-twig">&lt;label for="title"&gt;Task title&lt;/label&gt;
&lt;input id="title" name="title" type="text"
       {% if error == "title" %}aria-invalid="true" aria-describedby="title-error"{% endif %}
       required&gt;
{% if error == "title" %}
&lt;p id="title-error" class="error-message"&gt;
  {% if msg == "too_long" %}Title is too long (max 200 characters){% else %}Title is required{% endif %}
&lt;/p&gt;
{% endif %}
</code></pre>
<p><strong>Update GET /tasks route</strong> to pass error params:</p>
<pre><code class="language-kotlin">get("/tasks") {
    val error = call.request.queryParameters["error"]
    val msg = call.request.queryParameters["msg"]
    val q = call.request.queryParameters["q"].orEmpty()
    val page = call.request.queryParameters["page"]?.toIntOrNull() ?: 1
    val data = repo.search(q, page)

    val model = mapOf(
        "title" to "Tasks",
        "page" to data,
        "q" to q,
        "error" to error,
        "msg" to msg
    )

    val html = PebbleRender.render("tasks/index.peb", model)
    call.respondText(html, ContentType.Text.Html)
}
</code></pre>
<p><strong>Add CSS for error states</strong> (<code>static/style.css</code> or Pico CSS variables):</p>
<pre><code class="language-css">.error-summary {
  background: #fef7f7;
  border: 2px solid #d32f2f;
  padding: 1rem;
  margin-bottom: 1rem;
  border-radius: 4px;
}

.error-summary h2 {
  color: #d32f2f;
  font-size: 1.2rem;
  margin-top: 0;
}

.error-message {
  color: #d32f2f;
  font-size: 0.9rem;
  margin-top: 0.25rem;
}

input[aria-invalid="true"] {
  border-color: #d32f2f;
}
</code></pre>
<h3 id="step-3-test-both-paths-10-min"><a class="header" href="#step-3-test-both-paths-10-min">Step 3: Test both paths (10 min)</a></h3>
<p><strong>HTMX path</strong>:</p>
<ol>
<li>With JS enabled, submit empty form</li>
<li>Expect: Status message "Title is required." appears in <code>#status</code> live region</li>
<li>Form remains on page, input keeps focus</li>
<li>Try typing and submitting‚Äîshould succeed</li>
</ol>
<p><strong>No-JS path</strong>:</p>
<ol>
<li>Disable JS (DevTools ‚Üí Settings ‚Üí Disable JavaScript)</li>
<li>Submit empty form</li>
<li>Expect: Full page reload with error summary at top</li>
<li>Click error link ‚Üí focus moves to <code>#title</code> input</li>
<li>Fill form, submit ‚Üí redirect to <code>/tasks</code> with new task visible</li>
</ol>
<p>‚úã <strong>Stop and check</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Both paths show validation errors</li>
<li><input disabled="" type="checkbox"/>
HTMX errors use live region (announced by screen reader)</li>
<li><input disabled="" type="checkbox"/>
No-JS errors use summary with focusable link</li>
<li><input disabled="" type="checkbox"/>
Error messages are specific and actionable</li>
<li><input disabled="" type="checkbox"/>
Success path still works for both</li>
</ul>
<hr />
<h2 id="activity-b-harden-delete-flow-25-min"><a class="header" href="#activity-b-harden-delete-flow-25-min">Activity B: Harden Delete Flow (25 min)</a></h2>
<p>Delete is destructive‚Äîmust confirm and handle both JS/no-JS.</p>
<h3 id="step-1-add-confirmation-dialog-10-min"><a class="header" href="#step-1-add-confirmation-dialog-10-min">Step 1: Add confirmation dialog (10 min)</a></h3>
<p><strong>Update <code>templates/tasks/_item.peb</code></strong>:</p>
<p>Current button:</p>
<pre><code class="language-twig">&lt;button type="button" hx-delete="/tasks/{{ t.id }}" hx-target="#task-{{ t.id }}" hx-swap="outerHTML"&gt;
  Delete
&lt;/button&gt;
</code></pre>
<p><strong>Add confirmation + accessible label</strong>:</p>
<pre><code class="language-twig">&lt;button type="button"
        hx-delete="/tasks/{{ t.id }}"
        hx-target="#task-{{ t.id }}"
        hx-swap="outerHTML"
        hx-confirm="Delete the task '{{ t.title }}'?"
        aria-label="Delete task: {{ t.title }}"&gt;
  Delete
&lt;/button&gt;
</code></pre>
<p><strong>Why</strong>:</p>
<ul>
<li><code>hx-confirm</code> prompts before request (HTMX feature)</li>
<li><code>aria-label</code> provides context for screen readers (otherwise just "Delete Delete Delete..." in a list)</li>
</ul>
<h3 id="step-2-add-no-js-delete-support-15-min"><a class="header" href="#step-2-add-no-js-delete-support-15-min">Step 2: Add no-JS delete support (15 min)</a></h3>
<p><strong>Problem</strong>: <code>hx-delete</code> requires JavaScript. No-JS needs a form.</p>
<p><strong>Dual-path solution</strong>:</p>
<p>Replace button with <strong>form</strong> that works both ways:</p>
<pre><code class="language-twig">&lt;form action="/tasks/{{ t.id }}/delete" method="post" style="display: inline;"&gt;
  &lt;button type="submit"
          hx-delete="/tasks/{{ t.id }}"
          hx-target="#task-{{ t.id }}"
          hx-swap="outerHTML"
          hx-confirm="Delete the task '{{ t.title }}'?"
          aria-label="Delete task: {{ t.title }}"&gt;
    Delete
  &lt;/button&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Explanation</strong>:</p>
<ul>
<li><strong>No-JS</strong>: Form submits <code>POST /tasks/{id}/delete</code></li>
<li><strong>HTMX</strong>: <code>hx-delete</code> intercepts, sends <code>DELETE /tasks/{id}</code> instead</li>
<li>Both paths work!</li>
</ul>
<p><strong>Update routes</strong> (<code>src/main/kotlin/routes/Tasks.kt</code>):</p>
<pre><code class="language-kotlin">// HTMX path (HTTP DELETE)
delete("/tasks/{id}") {
    val id = call.parameters["id"]?.toIntOrNull() ?: return@delete call.respond(HttpStatusCode.BadRequest)
    val task = repo.get(id)
    repo.delete(id)

    val status = """&lt;div id="status" hx-swap-oob="true"&gt;Deleted "${task?.title ?: "task"}".&lt;/div&gt;"""
    // Return empty string (outerHTML swap removes the &lt;li&gt;)
    call.respondText(status, ContentType.Text.Html)
}

// No-JS path (POST fallback)
post("/tasks/{id}/delete") {
    val id = call.parameters["id"]?.toIntOrNull() ?: return@post call.respond(HttpStatusCode.BadRequest)
    repo.delete(id)
    call.respondRedirect("/tasks")
}
</code></pre>
<p><strong>Trade-off to document</strong>: No-JS delete has no confirmation (browser POST doesn't prompt). Options:</p>
<ol>
<li>Accept the trade-off (document in constraints doc)</li>
<li>Add intermediate confirmation page (<code>GET /tasks/{id}/delete/confirm</code>)</li>
<li>Use client-side confirmation (but that requires JS...)</li>
</ol>
<p>For this lab, <strong>accept and document</strong> the trade-off.</p>
<p>‚úã <strong>Stop and check</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
HTMX delete shows confirmation dialog</li>
<li><input disabled="" type="checkbox"/>
After confirm, task disappears with status message</li>
<li><input disabled="" type="checkbox"/>
No-JS delete submits form and redirects</li>
<li><input disabled="" type="checkbox"/>
Screen reader announces "Deleted [title]" (HTMX) or reads updated page (no-JS)</li>
</ul>
<hr />
<h2 id="activity-c-script-no-js-verification-20-min"><a class="header" href="#activity-c-script-no-js-verification-20-min">Activity C: Script No-JS Verification (20 min)</a></h2>
<p>Create a repeatable test script so anyone (teammate, tutor, future you) can verify parity.</p>
<h3 id="step-1-create-verification-document-15-min"><a class="header" href="#step-1-create-verification-document-15-min">Step 1: Create verification document (15 min)</a></h3>
<p><strong>Create <code>wk08/lab-w8/scripts/nojs-check.md</code></strong>:</p>
<pre><code class="language-markdown"># No-JS Parity Verification Script ‚Äî Week 8

**Purpose**: Verify all task flows work identically with JavaScript disabled.

**Setup**:
1. Open Chrome DevTools ‚Üí Settings ‚Üí Preferences ‚Üí Disable JavaScript
2. Alternatively: Use Firefox ‚Üí Settings ‚Üí Privacy &amp; Security ‚Üí Permissions ‚Üí Uncheck JavaScript
3. Hard refresh (Ctrl+Shift+R / Cmd+Shift+R) to clear cached JS

---

## Test 1: Add Task (Happy Path)

**Steps**:
1. Navigate to `/tasks`
2. Enter title "No-JS test task"
3. Click "Add Task"

**Expected**:
- Full page reload (check Network tab: only HTML request)
- New task appears in list
- URL remains `/tasks` (PRG redirect)
- No error messages

**Evidence**: Screenshot of task list with new task visible.

**Result**: [ ] Pass  [ ] Fail

---

## Test 2: Add Task (Validation Error)

**Steps**:
1. Leave title field empty
2. Click "Add Task"

**Expected**:
- Full page reload
- URL shows `/tasks?error=title`
- Error summary appears at top: "There is a problem"
- Link to "#title" input
- Input has red border, error message below
- Focus can navigate to error link and then to input

**Evidence**: Screenshot of error summary and highlighted input.

**Result**: [ ] Pass  [ ] Fail

---

## Test 3: Filter Tasks

**Steps**:
1. Add tasks "Alpha", "Bravo", "Charlie"
2. Enter "ra" in filter box
3. Click "Apply" or submit form

**Expected**:
- Full page reload
- URL shows `/tasks?q=ra&amp;page=1`
- Only "Bravo" and "Charlie" visible (partial match)
- Result count updates: "Showing 2 tasks"

**Evidence**: Screenshot of filtered results with URL visible.

**Result**: [ ] Pass  [ ] Fail

---

## Test 4: Pagination

**Steps**:
1. Add 15 tasks (assuming page size = 10)
2. Navigate to page 2 using "Next" link

**Expected**:
- Full page reload
- URL shows `/tasks?page=2`
- Tasks 11-15 visible
- "Previous" link appears
- "Next" link disabled or hidden

**Evidence**: Screenshot of page 2 with navigation controls.

**Result**: [ ] Pass  [ ] Fail

---

## Test 5: Edit Task (inline)

**Steps**:
1. Click "Edit" on a task
2. Change title to "Updated via no-JS"
3. Submit

**Expected**:
- Full page reload (or inline form renders in server response)
- URL remains `/tasks` or shows task context
- Updated title visible
- No JavaScript errors (none should exist)

**Evidence**: Screenshot of updated task.

**Result**: [ ] Pass  [ ] Fail

---

## Test 6: Delete Task

**Steps**:
1. Click "Delete" button on a task

**Expected**:
- Form submits to `POST /tasks/{id}/delete`
- Full page reload
- Task removed from list
- URL redirects to `/tasks`
- **No confirmation** (documented trade-off)

**Evidence**: Screenshot of task list with item removed.

**Result**: [ ] Pass  [ ] Fail

---

## Test 7: Keyboard Navigation

**Steps**:
1. Tab through entire page (skip link ‚Üí form ‚Üí tasks ‚Üí pagination)
2. Ensure visible focus indicator at each stop
3. Activate "Add Task" with Enter
4. Navigate to error link with Tab, activate with Enter

**Expected**:
- Focus order matches visual order
- All interactive elements reachable
- Enter activates links/buttons
- Focus visible on all elements

**Evidence**: Notes on tab order, screenshot of visible focus.

**Result**: [ ] Pass  [ ] Fail

---

## Test 8: Browser History

**Steps**:
1. Start at `/tasks`
2. Add task (redirects to `/tasks`)
3. Filter to "test" (reloads to `/tasks?q=test`)
4. Go to page 2 (reloads to `/tasks?q=test&amp;page=2`)
5. Click browser Back button twice

**Expected**:
- Back #1 ‚Üí `/tasks?q=test&amp;page=1` (filtered, page 1)
- Back #2 ‚Üí `/tasks?q=test` (filtered, page 1 implicit)
- Back #3 ‚Üí `/tasks` (no filter)
- History stack matches user intent

**Evidence**: Notes on history behaviour.

**Result**: [ ] Pass  [ ] Fail

---

## Summary

**Passed**: _____ / 8
**Failed**: _____ / 8

**Issues found**: (log in `backlog/backlog.csv` with IDs wk8-XX)

**Notes**:
- Attach screenshots to `evidence/wk8/nojs-parity/`
- Update `docs/prototyping-constraints.md` with any new trade-offs discovered
- Re-run this script after any route or template changes

---

**Verified by**: __________
**Date**: __________
</code></pre>
<h3 id="step-2-run-the-script-5-min"><a class="header" href="#step-2-run-the-script-5-min">Step 2: Run the script (5 min)</a></h3>
<p>Execute Tests 1-6 yourself. Capture screenshots in <code>evidence/wk8/nojs-parity/</code>.</p>
<p>Log any failures in <code>backlog/backlog.csv</code>:</p>
<pre><code class="language-csv">id,week,priority,category,description,wcag,status
wk8-01,8,high,functionality,"Delete has no confirmation in no-JS mode",,open
wk8-02,8,medium,ux,"Filter form submits on Enter but no visual feedback",,open
</code></pre>
<p>‚úã <strong>Stop and check</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Script documents all major flows</li>
<li><input disabled="" type="checkbox"/>
Script is repeatable by someone else</li>
<li><input disabled="" type="checkbox"/>
Evidence captured in structured folder</li>
<li><input disabled="" type="checkbox"/>
Failures logged in backlog</li>
</ul>
<hr />
<h2 id="activity-d-document-trade-offs-and-constraints-15-min"><a class="header" href="#activity-d-document-trade-offs-and-constraints-15-min">Activity D: Document Trade-offs and Constraints (15 min)</a></h2>
<p>Update <code>wk08/docs/prototyping-constraints.md</code> with a section on <strong>dual-path architecture trade-offs</strong>.</p>
<p><strong>Create or extend the file</strong>:</p>
<pre><code class="language-markdown"># Prototyping Constraints and Trade-offs ‚Äî Week 8

## Dual-Path Architecture

### Design Decision
Every route handles both HTMX (enhanced) and no-JS (baseline) requests.

### Benefits
- **Inclusion**: Works for everyone regardless of JS availability
- **Resilience**: Graceful degradation if JS fails to load
- **Testing**: Baseline path proves server-first architecture is sound
- **Progressive enhancement**: Start with accessible baseline, enhance with HTMX

### Costs
- **Code complexity**: Each route has conditional logic (`if (call.isHtmx())`)
- **Response duplication**: Must generate both fragments and full pages
- **Testing burden**: Every feature requires two test paths
- **Performance**: No-JS path triggers full page reloads (slower perceived performance)

### Risks
- **Divergence**: HTMX and no-JS paths could drift if not tested regularly
- **Error handling**: Easy to forget no-JS error path during rapid development
- **Template maintenance**: Changes to page structure must update both full templates and fragments

### Mitigations
- ‚úÖ **Verification script**: `scripts/nojs-check.md` provides repeatable tests
- ‚úÖ **Shared partials**: `_item.peb`, `_list.peb` used by both paths (single source of truth)
- ‚úÖ **Backlog tracking**: Log parity issues immediately (see `backlog/backlog.csv`)
- ‚úÖ **Weekly retesting**: Run no-JS script before each commit
- ‚ö†Ô∏è **Automated tests** (future): Playwright tests with JS disabled

---

## Validation Strategy

### Design Decision
All validation on server. No client-side validation (no `&lt;input required&gt;` enforcement).

### Benefits
- **Security**: Client-side validation can be bypassed (view source, disable JS, curl)
- **Consistency**: Same validation rules for HTMX and no-JS paths
- **Accessibility**: Server returns appropriate error format for each context

### Costs
- **Latency**: Must wait for server round-trip to see validation errors
- **UX**: No instant feedback on typos (could add client-side hints later)

### Risks
- **Frustration**: People might repeatedly submit invalid forms before reading error
- **Network dependency**: Offline users can't get any feedback

### Mitigations
- ‚úÖ **Clear error messages**: Specific, actionable text ("Title is required" not "Invalid input")
- ‚úÖ **Accessible error identification**: WCAG 3.3.1 compliance (aria-invalid, aria-describedby, role=alert)
- ‚úÖ **Focus management**: Error link navigates directly to problematic field
- üîÆ **Future enhancement**: Add client-side hints (maxlength indicator, real-time char count) as progressive enhancement

---

## Delete Confirmation

### Design Decision
HTMX path uses `hx-confirm` (browser confirmation dialog). No-JS path has no confirmation.

### Benefits
- **HTMX**: Prevents accidental deletions for JS-enabled users
- **Implementation simplicity**: No intermediate confirmation page needed

### Costs
- **Inconsistency**: Different UX depending on JS availability
- **Accessibility**: Browser confirm dialogs are not customisable (can't improve copy)

### Risks
- **Accidental deletion**: No-JS users might delete tasks by mistake
- **Compliance**: Depending on context, irreversible actions might require confirmation (WCAG 2.2.1 Timing Adjustable, 3.3.4 Error Prevention)

### Mitigations
- ‚úÖ **Documentation**: Trade-off explicitly noted in constraints doc
- ‚úÖ **Backlog item**: Consider adding `/tasks/{id}/delete/confirm` page for no-JS (low priority)
- ‚ö†Ô∏è **User research** (Week 9): Test whether delete accidents occur in pilots
- üîÆ **Future option**: Add "Undo" feature (restore from soft-delete within 30s)

---

## State Management

### Design Decision
Use query parameters for filter and page state (`?q=search&amp;page=2`).

### Benefits
- **Shareable**: URL captures full state (can bookmark or share filtered view)
- **History**: Back/forward buttons work predictably
- **No-JS compatible**: Query params work without JavaScript
- **Stateless server**: No session state needed for pagination

### Costs
- **URL pollution**: Long query strings for complex filters
- **Encoding**: Must properly encode/decode special characters
- **Analytics**: Harder to track "unique pages" if many query variations exist

### Risks
- **Drift**: If fragment requests use different query params than full page, state can desync
- **Limits**: Some servers/proxies have URL length limits (~2000 chars)

### Mitigations
- ‚úÖ **Consistent param names**: Use `q` and `page` everywhere
- ‚úÖ **Validation**: Sanitise and bound page numbers (reject negative, exceeds max)
- ‚úÖ **Encoding**: Use `call.request.queryParameters` (Ktor handles encoding)
- üîÆ **Future**: If filters grow complex, consider POST with session state

---

## Performance Considerations

### Active Search Debounce
- **Decision**: 300ms debounce on `hx-trigger="keyup changed delay:300ms"`
- **Benefit**: Reduces server load (doesn't fire on every keystroke)
- **Cost**: 300ms perceived latency before filter applies
- **Mitigation**: Show loading indicator (`hx-indicator`) during request

### Page Size
- **Decision**: 10 tasks per page
- **Benefit**: Fast page loads, manageable scroll
- **Cost**: More pagination clicks for large datasets
- **Mitigation**: Could add page size selector (10/25/50) in future

### Fragment Size
- **Decision**: Return `_list + _pager + status` (~2-5KB) instead of full page (~15KB)
- **Benefit**: 70% bandwidth reduction on filter/pagination
- **Cost**: Requires dual-path logic
- **Measurement**: Use browser DevTools Network tab to verify savings

---

## Evidence and Testing

**Verification scripts**: `wk08/lab-w8/scripts/nojs-check.md`
**Evidence folder**: `evidence/wk8/nojs-parity/`
**Backlog references**: IDs `wk8-01` to `wk8-XX`

**Review schedule**: Re-run parity tests after:
- Any route changes
- Template structure updates
- Before Week 9 instrumentation (ensure baseline is solid)
- Before Gradescope Task 1 submission

**Ownership**: Entire team responsible for verifying parity. Pair on changes: one person tests HTMX, another tests no-JS.
</code></pre>
<p>‚úã <strong>Stop and check</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Document includes design decisions, benefits, costs, risks, mitigations</li>
<li><input disabled="" type="checkbox"/>
Each trade-off links to evidence or backlog items</li>
<li><input disabled="" type="checkbox"/>
Future improvements noted with üîÆ prefix</li>
<li><input disabled="" type="checkbox"/>
Clear ownership and review schedule</li>
</ul>
<hr />
<h2 id="activity-e-retest-with-assistive-technology-20-min"><a class="header" href="#activity-e-retest-with-assistive-technology-20-min">Activity E: Retest with Assistive Technology (20 min)</a></h2>
<p>Now that error handling and delete confirmation are in place, verify accessibility.</p>
<h3 id="step-1-keyboard-testing-5-min"><a class="header" href="#step-1-keyboard-testing-5-min">Step 1: Keyboard testing (5 min)</a></h3>
<p><strong>Test error recovery</strong>:</p>
<ol>
<li>Submit empty form</li>
<li>Tab to error summary link</li>
<li>Press Enter ‚Üí focus moves to <code>#title</code> input</li>
<li>Type title, press Enter to submit</li>
<li>Verify success message appears</li>
</ol>
<p><strong>Test delete</strong>:</p>
<ol>
<li>Tab to Delete button</li>
<li>Press Enter ‚Üí confirmation dialog appears</li>
<li>Press Enter again to confirm</li>
<li>Verify screen reader announces deletion status</li>
</ol>
<p>‚úã Check:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Error link is keyboard-accessible</li>
<li><input disabled="" type="checkbox"/>
Error link moves focus to input when activated</li>
<li><input disabled="" type="checkbox"/>
Delete button keyboard-accessible</li>
<li><input disabled="" type="checkbox"/>
Confirmation dialog keyboard-accessible</li>
</ul>
<h3 id="step-2-screen-reader-testing-10-min"><a class="header" href="#step-2-screen-reader-testing-10-min">Step 2: Screen reader testing (10 min)</a></h3>
<p><strong>Use NVDA (Windows) or Orca (Linux)</strong>:</p>
<p><strong>Test error announcement (HTMX)</strong>:</p>
<ol>
<li>Forms mode (<code>F</code> key in NVDA) ‚Üí navigate to Add Task form</li>
<li>Leave title empty, submit</li>
<li>Listen for status region update: "Title is required."</li>
<li>Verify SR announces the error (live region should trigger)</li>
</ol>
<p><strong>Test error summary (no-JS)</strong>:</p>
<ol>
<li>Disable JS, submit empty form</li>
<li>SR should read: "Alert. There is a problem. List with 1 item. Link. Title is required."</li>
<li>Activate link ‚Üí SR announces: "Edit. Title."</li>
</ol>
<p><strong>Test delete status</strong>:</p>
<ol>
<li>Navigate to Delete button</li>
<li>SR announces: "Delete task: [title]. Button."</li>
<li>Activate, confirm</li>
<li>SR announces: "Deleted [title]." (from live region)</li>
</ol>
<p>‚úã Check:</p>
<ul>
<li><input disabled="" type="checkbox"/>
HTMX errors announced via live region</li>
<li><input disabled="" type="checkbox"/>
No-JS errors announced via alert role</li>
<li><input disabled="" type="checkbox"/>
Delete button has accessible name</li>
<li><input disabled="" type="checkbox"/>
Delete confirmation accessible</li>
<li><input disabled="" type="checkbox"/>
Status messages announced</li>
</ul>
<h3 id="step-3-no-js-screen-reader-test-5-min"><a class="header" href="#step-3-no-js-screen-reader-test-5-min">Step 3: No-JS screen reader test (5 min)</a></h3>
<p>Disable JS and repeat error flow with screen reader:</p>
<ol>
<li>Submit empty form (no-JS)</li>
<li>SR reads error summary</li>
<li>Activate error link</li>
<li>Verify focus lands on input</li>
<li>Fill form, submit</li>
<li>Verify SR reads updated page</li>
</ol>
<p>‚úã Check:</p>
<ul>
<li><input disabled="" type="checkbox"/>
Error summary is first thing announced after page load</li>
<li><input disabled="" type="checkbox"/>
Error links are navigable</li>
<li><input disabled="" type="checkbox"/>
Focus management works</li>
<li><input disabled="" type="checkbox"/>
Success state is clear</li>
</ul>
<p><strong>Document findings</strong>: Add any issues to <code>backlog/backlog.csv</code>. Capture screen reader output in <code>evidence/wk8/sr-testing.txt</code>.</p>
<hr />
<h2 id="commit--reflect-10-min"><a class="header" href="#commit--reflect-10-min">Commit &amp; Reflect (10 min)</a></h2>
<h3 id="commit-message"><a class="header" href="#commit-message">Commit message</a></h3>
<pre><code class="language-bash">git add src/main/kotlin/routes/Tasks.kt templates/tasks/index.peb templates/tasks/_item.peb wk08/lab-w8/scripts/nojs-check.md wk08/docs/prototyping-constraints.md evidence/wk8/ backlog/backlog.csv

git commit -m "$(cat &lt;&lt;'EOF'
wk8s2: dual-path validation, no-JS parity, trade-offs doc

- Added server-side validation for create (blank, max length)
- Dual-path error handling: HTMX (OOB status) vs no-JS (redirect + summary)
- Accessible error identification: aria-invalid, aria-describedby, role=alert
- Hardened delete flow: hx-confirm for HTMX, form fallback for no-JS
- Created repeatable no-JS verification script (scripts/nojs-check.md)
- Documented dual-path trade-offs, risks, mitigations (docs/prototyping-constraints.md)
- Tested with keyboard and screen reader (NVDA/Orca)
- Evidence captured in evidence/wk8/nojs-parity/

Trade-off accepted: No-JS delete has no confirmation (documented in constraints)

ü§ñ Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude &lt;noreply@anthropic.com&gt;
EOF
)"
</code></pre>
<h3 id="reflection-questions"><a class="header" href="#reflection-questions">Reflection questions</a></h3>
<p><strong>Answer in <code>wk08/reflection.md</code></strong>:</p>
<ol>
<li>
<p><strong>Dual-path complexity</strong>: Was it harder to maintain HTMX and no-JS paths than you expected? What helped keep them in sync?</p>
</li>
<li>
<p><strong>Error handling</strong>: How did accessible error identification change your approach? Did you discover any WCAG requirements you hadn't considered?</p>
</li>
<li>
<p><strong>Trade-offs</strong>: Which trade-off (e.g., no-JS delete confirmation) felt most significant? Would you design it differently with more time?</p>
</li>
<li>
<p><strong>Testing</strong>: How useful was the scripted no-JS verification? Will you use similar scripts in future projects?</p>
</li>
<li>
<p><strong>Inclusion impact</strong>: Who specifically benefits from the dual-path architecture? Think about connectivity, device age, organisational policies.</p>
</li>
<li>
<p><strong>Next steps</strong>: What would you improve before Week 9 instrumentation? Any technical debt to address?</p>
</li>
</ol>
<hr />
<h2 id="looking-ahead-week-9-evaluation"><a class="header" href="#looking-ahead-week-9-evaluation">Looking Ahead: Week 9 Evaluation</a></h2>
<p>Next week you'll instrument your prototype to capture metrics during peer pilots:</p>
<ul>
<li><strong>Task completion time</strong>: How long to add/edit/delete tasks</li>
<li><strong>Error rates</strong>: How often do validation errors occur</li>
<li><strong>No-JS performance</strong>: Compare HTMX vs no-JS completion times</li>
<li><strong>Confidence ratings</strong>: Post-task subjective feedback</li>
</ul>
<p><strong>Why this week matters</strong>: You can't evaluate a prototype that doesn't handle errors gracefully. Week 8 Lab 2 ensures your baseline is solid before adding instrumentation.</p>
<p><strong>Preparation</strong>:</p>
<ul>
<li>Verify all flows work (HTMX + no-JS)</li>
<li>Ensure backlog is up to date</li>
<li>Review <a href="../references/evaluation-metrics-quickref.html">Evaluation Metrics Quick Reference</a> to understand what data you'll collect</li>
</ul>
<hr />
<h2 id="further-reading--resources"><a class="header" href="#further-reading--resources">Further Reading &amp; Resources</a></h2>
<h3 id="essential"><a class="header" href="#essential">Essential</a></h3>
<ul>
<li><a href="https://www.w3.org/WAI/WCAG22/Understanding/input-assistance">WCAG 3.3: Input Assistance</a> ‚Äî Error identification and prevention</li>
<li><a href="https://design-system.service.gov.uk/components/error-message/">GOV.UK: Error Message Pattern</a> ‚Äî Accessible error design</li>
<li><a href="https://webaim.org/articles/formvalidation/">WebAIM: Form Validation</a> ‚Äî Screen reader considerations</li>
</ul>
<h3 id="htmx-patterns"><a class="header" href="#htmx-patterns">HTMX Patterns</a></h3>
<ul>
<li><a href="../references/htmx-pattern-cheatsheet.html">HTMX Pattern Cheatsheet</a> ‚Äî OOB status, confirmation, error handling</li>
<li><a href="https://htmx.org/examples/inline-validation/">HTMX: Validation Example</a> ‚Äî Alternative inline pattern</li>
<li><a href="https://htmx.org/attributes/hx-confirm/">HTMX: hx-confirm</a> ‚Äî Confirmation dialogs</li>
</ul>
<h3 id="testing"><a class="header" href="#testing">Testing</a></h3>
<ul>
<li><a href="../references/assistive-testing-checklist.html">Assistive Testing Checklist</a> ‚Äî Weekly testing checklist</li>
<li><a href="https://www.gov.uk/service-manual/technology/testing-with-assistive-technologies">GOV.UK: Testing with Assistive Technologies</a></li>
<li><a href="https://webaim.org/articles/screenreader_testing/">WebAIM: Screen Reader Testing</a></li>
</ul>
<h3 id="progressive-enhancement"><a class="header" href="#progressive-enhancement">Progressive Enhancement</a></h3>
<ul>
<li><a href="https://alistapart.com/article/understandingprogressiveenhancement/">A List Apart: Understanding Progressive Enhancement</a></li>
<li><a href="https://hypermedia.systems/progressive-enhancement/">hypermedia.systems: Progressive Enhancement</a></li>
<li><a href="https://www.gov.uk/service-manual/technology/using-progressive-enhancement">GOV.UK: Building a Resilient Frontend</a></li>
</ul>
<h3 id="academic"><a class="header" href="#academic">Academic</a></h3>
<ul>
<li><strong>Nielsen, J. (1994).</strong> <em>Heuristic evaluation.</em> In <em>Usability inspection methods</em> (pp. 25-62). ‚Äî Error prevention heuristic</li>
<li><strong>W3C (2023).</strong> <em>Web Content Accessibility Guidelines (WCAG) 2.2.</em> ‚Äî 3.3.1, 3.3.3, 4.1.3</li>
</ul>
<hr />
<h2 id="glossary-summary"><a class="header" href="#glossary-summary">Glossary Summary</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>One-line definition</th></tr></thead><tbody>
<tr><td><strong>Server-side validation</strong></td><td>Validation logic executed on the server; required for security and no-JS parity</td></tr>
<tr><td><strong>Post-Redirect-Get (PRG)</strong></td><td>Pattern where POST responds with redirect to prevent duplicate submissions</td></tr>
<tr><td><strong>Dual-path architecture</strong></td><td>Single route handles both HTMX (fragment) and no-JS (full page) requests</td></tr>
<tr><td><strong>Accessible error identification</strong></td><td>WCAG 3.3.1: Errors identified in text and programmatically associated with inputs</td></tr>
<tr><td><strong>No-JS parity testing</strong></td><td>Verifying all functionality works identically with JavaScript disabled</td></tr>
<tr><td><strong>Progressive enhancement</strong></td><td>Build accessible baseline first, then enhance with JavaScript as enhancement layer</td></tr>
<tr><td><strong>Live region</strong></td><td>ARIA region (<code>role="status"</code> or <code>aria-live</code>) that announces dynamic content changes</td></tr>
<tr><td><strong>hx-confirm</strong></td><td>HTMX attribute that shows browser confirmation dialog before sending request</td></tr>
<tr><td><strong>aria-invalid</strong></td><td>ARIA attribute indicating field contains validation error (<code>true</code>/<code>false</code>)</td></tr>
<tr><td><strong>aria-describedby</strong></td><td>ARIA attribute linking field to descriptive text (hint or error message)</td></tr>
</tbody></table>
</div>
<hr />
<p><strong>Lab complete!</strong> You now have a robust, accessible, dual-path prototype ready for evaluation instrumentation in Week 9.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../wk08/wk8-lab1-prototyping-constraints.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../resources/code-resources.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../wk08/wk8-lab1-prototyping-constraints.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../resources/code-resources.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>



    </div>
    </body>
</html>
